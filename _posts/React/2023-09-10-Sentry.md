---
title: "Sentryë¥¼ ì‚¬ìš©í•œ ì—ëŸ¬ ìˆ˜ì§‘"

categories:
  - React
tags:
  - Sentry

toc: true
toc_sticky: true
toc_label: "ëª©ì°¨"

date: 2023-09-10
last_modified_at: 2022-10-02
---

## 1. ê°œìš”

> "í˜¹ì‹œ ì–´ë–¤ ìƒí™©ì—ì„œ ë°œìƒí•˜ì…¨ë‚˜ìš”?, ì €ëŠ” ì¬í˜„ì´ ì•ˆë˜ëŠ”ë°ìš”??"

íšŒì‚¬ì—ì„œ ê°œë°œì„ í•˜ë‹¤ê°€ íŒ€ì›ë¶„ê»˜ì„œ ë•Œë•Œë¡œ ì—ëŸ¬ìƒí™©ì— ëŒ€í•´ ì „ë‹¬í•´ì£¼ì‹¤ë•Œê°€ ì¢…ì¢… ìˆìŠµë‹ˆë‹¤.

ë¬¸ì œëŠ” ë°œìƒìƒí™©ì„ ë§ì”€í•´ì£¼ì…”ë„ ì¬í˜„ì´ ì•ˆë˜ê±°ë‚˜, í•˜ë‚˜í•˜ë‚˜ ì „ë‹¬ë°›ì„ë•Œë§ˆë‹¤ ì²˜ë¦¬í•˜ëŠ”ê²Œ ì¢‹ì€ êµ¬ì¡°ëŠ” ì•„ë‹ˆë¼ê³  ìƒê°í–ˆì–´ìš”.

ë°œìƒ ë‹¹ì‹œì˜ ë¡œê·¸ë¥¼ íŒŒì•…í•´ì•¼í•˜ê³ , ê·¸ë‚˜ë§ˆ ë°°í¬ì „ì— ë°œê²¬í•´ì„œ ë§ì •ì´ì§€ ì‹¤ ì‚¬ìš©ìì—ê²Œ ë¡œê·¸ë¥¼ ì°ì–´ë‹¬ë¼ê³  ë¶€íƒí•  ìˆ˜ëŠ” ì—†ê¸°ë•Œë¬¸ì…ë‹ˆë‹¤.

ë”êµ°ë‹¤ë‚˜ ì‚¬ìš©ìì˜ ë¸Œë¼ìš°ì €ì— ë”°ë¼ í˜¸í™˜ì„±ë¬¸ì œë„ ê°ê¸° ë‹¤ë¥´ê²Œ ë°œìƒí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì—ëŸ¬ë¥¼ ì¶”ì²™í•˜ê³  ëª¨ë‹ˆí„°ë§í•˜ê¸° ìœ„í•œ ê¸°ìˆ ì€ í•„ìˆ˜ì ì´ë¼ê³  ìƒê°í–ˆìŠµë‹ˆë‹¤.

ì´ëŸ° ìƒí™©ì´ ë°œìƒí–ˆì„ ë•Œ ë¹ ë¥´ê²Œ ëŒ€ì‘í•  ìˆ˜ ìˆëŠ” ë„êµ¬ê°€ ìˆìœ¼ë©´ ì–´ë–¨ê¹Œìš”?

## 2. Sentry

Sentryë€ ì‹¤ì‹œê°„ìœ¼ë¡œ ì—ëŸ¬ë¥¼ ì¶”ì í•˜ê³ , ë¶„ì„í•˜ì—¬ ì•Œë ¤ì£¼ëŠ” ì˜¤í”ˆ ì†ŒìŠ¤ ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤.

ì—ëŸ¬ì— ëŒ€í•œ ì•Œë¦¼, ì‚¬ìš©ìì˜ ë¸Œë¼ìš°ì €ë‚˜ ê¸°ê¸° ì •ë³´ ë° ì´ëŸ¬í•œ ì •ë³´ë¥¼ ëŒ€ì‹œë³´ë“œí˜•íƒœë¡œ ì‹œê°í™”í•˜ê³  ì—ëŸ¬ë¥¼ ì¶”ì í•˜ê¸° ì‰½ê²Œ ë„ì™€ì£¼ëŠ” ì—¬ëŸ¬ê°€ì§€ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•´ì£¼ê³  ìˆìŠµë‹ˆë‹¤.

SentryëŠ” ì´ëŸ¬í•œ ê³¼ì œë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ê°•ë ¥í•œ ë„êµ¬ë¡œ, íŒ€ì˜ ìƒì‚°ì„± í–¥ìƒê³¼ ì‚¬ìš©ì ë§Œì¡±ë„ í–¥ìƒì— í¬ê²Œ ê¸°ì—¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤

### 2.1 ì‚¬ìš©ë²•

1. https://sentry.io/welcome/ ì‚¬ì´íŠ¸ë¥¼ í†µí•´ íšŒì›ê°€ì…ì„ ì§„í–‰

2. í”„ë¡œì íŠ¸ë¥¼ ìƒì„±

3. Reactì—ì„œ SDK ì„¤ì •

   ```
   yarn add @sentry/react
   ```

   ```javascript
   // index.tsx

   // Sentryì—ì„œ ì œê³µí•˜ëŠ” ê¸°ë³¸ ì‹œì‘ ì„¸íŒ…

   Sentry.init({
     dsn: "your key", // Sentry ì„œë²„ì— ë¡œê·¸ë¥¼ ë³´ë‚´ëŠ”ë° í•„ìš”í•œ ì¸ì¦ ì •ë³´
     integrations: [
       new Sentry.BrowserTracing({
         tracePropagationTargets: [
           "localhost",
           /^https:\/\/yourserver\.io\/api/,
         ],
       }),
       new Sentry.Replay(),
     ],
     // Performance Monitoring
     tracesSampleRate: 1.0, // ë°ì´í„° ìƒ˜í”Œë§ ë¹„ìœ¨ ì„¤ì •
     // Session Replay
     replaysSessionSampleRate: 0.1,
     replaysOnErrorSampleRate: 1.0,
   });
   ```

4. ì—ëŸ¬ ë°œìƒì‹œí‚¤ê¸°

   ```javascript
   import * as Sentry from "@sentry/react";

     const causeCustomError = () => {
       try {
         throw new Error("ì»¤ìŠ¤í…€ ì—ëŸ¬ ë°œìƒ");
       } catch (error) {
         console.error(error);
         Sentry.captureException(error); // ì—ëŸ¬ë¥¼ Sentryì— ì „ì†¡
       }
     };


   {...}

   return (
       <div>
         <button onClick={causeCustomError}> Custom Error</button>
       </div>
     );

   ```

### 2.2 ê¸°ë³¸ ì˜µì…˜

**[Sentry SDK ì„¤ì • ì˜µì…˜]**

- dsn

  - SDKì—ê²Œ ì´ë²¤íŠ¸ë¥¼ ì–´ë””ë¡œ ë³´ë‚¼ì§€ ì•Œë ¤ì£¼ëŠ” ì‹ë³„ì
  - ë³´ì•ˆì„ ìœ„í•´ ë³„ë„ì˜ envíŒŒì¼ë¡œ ê´€ë¦¬

- release

  - ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ë²„ì „ì„ í‘œí˜„í•˜ê¸° ìœ„í•´ ì‚¬ìš©
  - ê° ë¦´ë¦¬ì¦ˆë³„ë¡œ ì˜¤ë¥˜ ì¶”ì ì´ ê°€ëŠ¥í•˜ê¸°ë•Œë¬¸ì— ë¦´ë¦¬ì¦ˆë³„ë¡œ ì˜¤ë¥˜ë¥¼ ë¶„ì„í•˜ê¸° ìš©ì´

- tracesSampleRate

  - Sentryì— ë³´ë‚´ëŠ” íŠ¸ëœì­ì…˜ì˜ ìƒ˜í”Œ ë¹„ìœ¨ (0.0 ~ 1.0)
  - ë„ˆë¬´ ë§ì€ ì´ë²¤íŠ¸ë¥¼ ê¸°ë¡í•˜ì§€ ì•Šë„ë¡ ë¶€í•˜ë¥¼ ì¡°ì ˆ

- replaysSessionSampleRate

  - Sentry SDKì—ì„œ ì„¸ì…˜ ë¦¬í”Œë ˆì´ ê¸°ëŠ¥ì˜ ìƒ˜í”Œë§ ë¹„ìœ¨ì„ ì œì–´

- replaysOnErrorSampleRate

  - ì˜¤ë¥˜ê°€ ë°œìƒí•œ ì„¸ì…˜ ì¤‘ ì–´ëŠ ì •ë„ì˜ ë¹„ìœ¨ë¡œ ë¦¬í”Œë ˆì´ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í• ì§€ ê²°ì •

![video](https://github.com/teawon/Sentry-React-Practice/assets/78795820/b5d1c502-2591-4da4-98c4-5b7828dc02a5)

> Replayë€ ìœ„ ì˜ìƒì²˜ëŸ¼ ì—ëŸ¬ê°€ ë°œìƒí•œ ìƒí™©ì´ ê·¸ëŒ€ë¡œ ë…¹í™”ë˜ëŠ” ê¸°ëŠ¥

- maxBreadcrumbs
  - ìµœëŒ€ breadcrumbì˜ ì–‘ì„ ì œì–´ (ìµœê·¼ nê°œì˜ ë°ì´í„°ë§Œ ìœ ì§€í•˜ê³  ì‚­ì œí•œë‹¤)

![image](https://github.com/teawon/Sentry-React-Practice/assets/78795820/44c74327-d891-46f6-b01a-a5786e81542a)

> breadcrumbë€ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ê¸° ì´ì „ì— ì–´ë–¤ ì¼ì´ ì¼ì–´ë‚¬ëŠ”ì§€ í‘œí˜„í•´ì£¼ëŠ” Sentryì˜ ê¸°ëŠ¥ ì¤‘ í•˜ë‚˜

tracePropagationTargets

- ì„¤ì •ëœ URL íŒ¨í„´ì— ëŒ€í•´ì„œë§Œ ì¶”ì  ì •ë³´ë¥¼ ì „íŒŒ

ê·¸ ë°–ì˜ ì˜µì…˜ì€ [ê³µì‹ë¬¸ì„œ](https://docs.sentry.io/platforms/javascript/configuration/options/?original_referrer=https%3A%2F%2Ftech.kakaopay.com%2F)ì„ ì°¸ê³  ë¶€íƒë“œë¦½ë‹ˆë‹¤.

**[ì—ëŸ¬ ì „ì†¡ ë©”ì„œë“œ]**

- captureException
  - ì˜ˆì™¸ ê°ì²´ë¥¼ ì¸ìë¡œ ë°›ì•„ Sentryì— ì—ëŸ¬ë¥¼ ë³´ê³ 

```javascript
try {
  // Potentially erroneous code
  const value = someFunctionThatMightThrow();
} catch (error) {
  Sentry.captureException(error);
}
```

- captureMessage
  - ë¬¸ìì—´ ë©”ì‹œì§€ë¥¼ ì¸ìë¡œ ë°›ì•„ Sentryì— ì—ëŸ¬ë¥¼ ë³´ê³ 

```javascript
if (someUnexpectedCondition) {
  Sentry.captureMessage("ì—ëŸ¬ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
}
```

### 2.3 ì—ëŸ¬ë¥¼ êµ¬ë¶„ì§“ê¸°

ìœ„ ë°©ì‹ì— ë”í•´ì„œ, ìˆ˜ ë§ì€ ì—ëŸ¬ë“¤ì„ ë¬´ë¶„ë³„í•˜ê²Œ ìˆ˜ì§‘í•˜ê³  ê´€ë¦¬í•œë‹¤ë©´ ë¬¸ì œì ì„ ë¹ ë¥´ê²Œ íŒŒì•…í•˜ê³  ê´€ë¦¬í•˜ê¸° ì‰½ì§€ ì•Šì„ ê²ƒ ì…ë‹ˆë‹¤. ì‚¬ì‹¤ ì¤‘ìš”í•˜ê²Œ í™•ì¸í•´ì•¼í•˜ëŠ” ì—ëŸ¬ëŠ” ë”°ë¡œ ìˆì„í…Œë‹ˆê¹Œìš”

ì´ë¥¼ ìœ„í•´ Sentryì—ì„œëŠ” ì—ëŸ¬ì˜ ì¤‘ìš”ë„ë¥¼ êµ¬ë¶„ì§“ê±°ë‚˜ ì •ë³´ë¥¼ ë³´ë‚´ëŠ” ë°©ë²•ì„ ì œê³µí•˜ê³ ìˆìŠµë‹ˆë‹¤.

#### 2.3.1 Scope

ScopeëŠ” Sentryì—ì„œ ì´ë²¤íŠ¸ë¥¼ ìº¡ì²˜í•˜ê¸° ì „ì— ì´ë²¤íŠ¸ ë°ì´í„°ì— ì¶”ê°€ ì •ë³´ë¥¼ ì¶”ê°€í•˜ê±°ë‚˜ ìˆ˜ì •í•  ìˆ˜ ìˆëŠ” ë°©ë²•ìœ¼ë¡œ

íŠ¹ì • ë²”ìœ„(Scope) ë‚´ì—ì„œ ë°œìƒí•œ ëª¨ë“  ì´ë²¤íŠ¸ëŠ” í•´ë‹¹ ë²”ìœ„ì— ì„¤ì •ëœ ë§¤ê°œë³€ìˆ˜ì™€ í•¨ê»˜ ì „ì†¡ë©ë‹ˆë‹¤.

- configureScope
  - ê¸€ë¡œë²Œ scopeì— ëŒ€í•œ ì„¤ì •ì„ ì ìš©í•©ë‹ˆë‹¤ (ëª¨ë“  ì´ë²¤íŠ¸ì— ëŒ€í•´ ê³µí†µì ìš©)
  - ì‚¬ìš©ì ì •ë³´ ë“±

```javascript
Sentry.configureScope(function (scope) {
  scope.setTag(userType, "admin");
  scope.setUser({ email: "admin@example.com" });
});

Sentry.captureException(new Error("This is another error"));
```

- withScope
  - í•´ë‹¹ ë²”ìœ„ì—ì„œë§Œ ì„¤ì •ì„ ì ìš©í•©ë‹ˆë‹¤
  - ì—ëŸ¬ ìƒí™©ì— ëŒ€í•œ ìƒì„¸ ë‚´ìš©

```javascript
Sentry.withScope(function (scope) {
  scope.setTag("page_locale", "en-US");
  scope.setLevel(Sentry.Severity.Warning);

  Sentry.captureException(new Error("This is an error"));
});
```

Scopeì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë©”ì„œë“œë“¤

- setTag: ì´ë²¤íŠ¸ì— íƒœê·¸ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
- setUser: ì´ë²¤íŠ¸ì— ì‚¬ìš©ì ì •ë³´ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
- setLevel: ì´ë²¤íŠ¸ì˜ ì¤‘ìš”ë„ ë ˆë²¨ì„ ì„¤ì •í•©ë‹ˆë‹¤.
- setExtras: ì´ë²¤íŠ¸ì— ì¶”ê°€ ë°ì´í„°ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.
- addEventProcessor: Scopeì— ì´ë²¤íŠ¸ í”„ë¡œì„¸ì„œë¥¼ ì¶”ê°€í•˜ì—¬ ì´ë²¤íŠ¸ ë°ì´í„°ë¥¼ ìˆ˜ì •í•˜ê±°ë‚˜ ì¡°ì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì¦‰ Scopeì— ë”°ë¼ ì—ëŸ¬ ì¶”ì ì— ìˆì–´ì„œ í•„ìš”í•œ ë©”íƒ€ë°ì´í„°ë¥¼ ì¶”ê°€í•˜ê³ , ë¡œê¹…ì„ ë”ìš± íš¨ê³¼ì ìœ¼ë¡œ ìˆ˜í–‰í•  ìˆ˜ ìˆë„ë¡ ë•ìŠµë‹ˆë‹¤.

#### 2.3.2 Level

ë ˆë²¨ ì„¤ì •ì€ ë¡œê¹… ì‹œìŠ¤í…œì—ì„œ ì¤‘ìš”í•œ ë¶€ë¶„ìœ¼ë¡œ, ë¡œê·¸ ë©”ì‹œì§€ê°€ ì–¼ë§ˆë‚˜ ì‹¬ê°í•œì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤

- ê°œë³„ ì´ë²¤íŠ¸ì— ëŒ€í•œ ë ˆë²¨ ì„¤ì •

  ```javascript
  Sentry.captureMessage("ë””ë²„ê·¸ ë ˆë²¨ì˜ ì—ëŸ¬ ë°œìƒ", "debug");
  ```

- Scope ë‚´ë¶€ì—ì„œ ì •ì˜

  ```javascript
  Sentry.withScope(function (scope) {
    scope.setLevel("fatal");

    Sentry.captureException(new Error("ë§¤ìš° ì‹¬ê°í•œ ì—ëŸ¬ ë°œìƒ"));
  });
  ```

ìˆœì„œëŒ€ë¡œ `fatal, error, warning, log, info, debug` ë ˆë²¨ì •ë³´ê°€ ìˆìŠµë‹ˆë‹¤.

<img width="782" alt="image" src="https://github.com/teawon/Sentry-React-Practice/assets/78795820/455c820b-a635-42cd-ad4a-02f157a922ae">

> Sentry ì´ë²¤íŠ¸ì˜ ë ˆë²¨ì„ ì„¸ë°€í•˜ê²Œ ì œì–´í•  ìˆ˜ ìˆìœ¼ë©°, ì´ë¥¼ í†µí•´ ë¡œê·¸ì˜ ì¤‘ìš”ë„ë¥¼ êµ¬ë¶„í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìˆë‹¤

#### 2.3.3 Context

ê°œë³„ ì—ëŸ¬ ì´ë²¤íŠ¸ì— ëŒ€í•´ ì¶”ê°€ì •ë³´ë¥¼ ì œê³µí•˜ê¸° ìœ„í•´ contextë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê¸°ë³¸ì ìœ¼ë¡œ ì—ëŸ¬ ë°œìƒ ì‹œê°, ì‚¬ìš©ì ê¸°ê¸°, ë¸Œë¼ìš°ì €, ì—ëŸ¬ íƒ€ì…ë“± ë°œìƒì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìœ¼ë‚˜, ê¸°íƒ€ ì„¸ë¶€ì •ë³´ë¥¼ ì¶”ê°€ì ìœ¼ë¡œ ê¸°ë¡í•˜ë©´ ë°œìƒí•œ ì—ëŸ¬ì— ëŒ€í•œ ì •ë³´ì™€ ì˜í–¥ì„ ì‰½ê²Œ í™•ì¸í•  ìˆ˜ ìˆê² ì£ 

```javascript
const causeNetworkError = async () => {
  try {
    const response = await fetch(
      "https://api.causeNetworkError.com/causeNetworkError"
    );

    if (!response.ok) {
      throw new Error("Network error: " + response.statusText);
    }
  } catch (error) {
    console.error(error);
    Sentry.withScope((scope) => {
      scope.setContext("apiInfo", {
        url: "https://api.causeNetworkError.com/causeNetworkError",
        method: "GET",
        status: 401,
        // (í—¤ë”, íŒŒë¼ë¯¸í„° ë“±ì˜ ì¶”ê°€ì •ë³´ ë“±ë¡)
      });
      scope.setTag("errorType", "NetworkError"); // íƒœê·¸ ì„¤ì •
      scope.setLevel("fatal"); // ë ˆë²¨ ì„¤ì •
      Sentry.captureException(error); // ì—ëŸ¬ë¥¼ Sentryì— ì „ì†¡
    });
  }
};
```

> apiì™€ ê°™ì´ ë¬¸ì œìƒí™©ì„ ì‹ë³„í•  ìˆ˜ ìˆëŠ” ì •ë³´ë¥¼ ì¶”ê°€ë¡œ ë‹´ìœ¼ë©´ ë¡œê¹…ì— ë” ìš©ì´

#### 2.3.3 Fingerprint

SentryëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì˜¤ë¥˜ ìŠ¤íƒ íŠ¸ë ˆì´ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜¤ë¥˜ë¥¼ ê·¸ë£¹í™”í•©ë‹ˆë‹¤.

ê·¸ëŸ¬ë‚˜ ê²½ìš°ì— ë”°ë¼ ì‚¬ìš©ìëŠ” ì´ëŸ¬í•œ ê·¸ë£¹í™” ë°©ì‹ì„ ë” ì„¸ë°€í•˜ê²Œ ì œì–´í•˜ê³  ì‹¶ì„ ìˆ˜ ìˆê² ì£ . ì´ ë•Œ fingerprintë¥¼ ì‚¬ìš©í•˜ì—¬ ì˜¤ë¥˜ë¥¼ ì›í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ê·¸ë£¹í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<img width="1235" alt="image" src="https://github.com/teawon/Sentry-React-Practice/assets/78795820/e3e5f64f-4970-450b-9593-30bc5e5a069d">

> AxiosErrorê°€ ëª¨ë‘ í•˜ë‚˜ë¡œ ê·¸ë£¹í™”ë˜ì–´ í‘œí˜„ëœë‹¤.
>
> ì—ëŸ¬ ìƒíƒœë¥¼ í™•ì¸í•˜ë ¤ë©´ ê·¸ë£¹ë‚´ë¶€ì—ì„œ í•˜ë‚˜í•˜ë‚˜ ë‚´ìš©ì„ í™•ì¸í•´ì„œ ë¶ˆí¸

ì´ë•Œ Sentry.withScope ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ fingerprintë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

Apiì˜ ê²½ìš° ìƒíƒœì½”ë“œì— ë”°ë¼ nameì†ì„±ì„ ë°”ê¾¸ë©´ ë” êµ¬ì²´ì ì¸ ëª…ì¹­ìœ¼ë¡œ ì—ëŸ¬ë¥¼ ê·¸ë£¹í™”í•˜ê³  í™•ì¸í•  ìˆ˜ ìˆê² ì£ 

```javascript

    {...}

    Sentry.withScope((scope) => {

      scope.setFingerprint([
        originalRequest.method,
        error.response?.status,
        originalRequest.url,
      ]);

      error.name = errorType;
      Sentry.captureException(error);
    });

```

<img width="910" alt="image" src="https://github.com/teawon/Sentry-React-Practice/assets/78795820/42ccd778-7d92-4be0-ae98-698d985fa24b">

> method, url , statusì— ë”°ë¼ ê·¸ë£¹í•‘ì„ í•˜ê³ , ìƒíƒœì½”ë“œì— ë”°ë¼ ì ì ˆí•œ ëª…ì¹­ì„ ë¶€ì—¬

## 3 Source Map

ì†ŒìŠ¤ë§µì„ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë©´ ê¸°ë³¸ì ìœ¼ë¡œ ì—ëŸ¬ê°€ ë°œìƒëœ ì½”ë“œì˜ ìœ„ì¹˜ê°€ í‘œí˜„ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.

ì™œëƒí•˜ë©´ ë°°í¬ í”„ë¡œì„¸ìŠ¤ë¥¼ ê±°ì¹˜ë©´ ìµœì í™”,ë‚œë…í™”,ìµœì†Œí™” ê°™ì€ ë³€í™˜ í”„ë¡œì„¸ìŠ¤ë¥¼ ê±°ì³ ì›ë³¸ ì†ŒìŠ¤ì½”ë“œì™€ ë‹¤ë¥´ê²Œ ë°°í¬ë˜ê¸°ë•Œë¬¸ì— ì—ëŸ¬ê°€ ë°œìƒí•œ ìœ„ì¹˜ë„ ì›ë³¸ ì†ŒìŠ¤ ì½”ë“œì™€ ë§¤ì¹­í•  ìˆ˜ ì—†ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤.

ì†ŒìŠ¤ë§µì€ ì´ëŸ¬í•œ ë¬¸ì œì ì„ í•´ê²°í•˜ê¸° ìœ„í•´ ë³€í™˜ëœ ì½”ë“œì™€ ì›ë³¸ ì½”ë“œ ì‚¬ì´ì˜ ë§¤í•‘ì„ ì œê³µí•©ë‹ˆë‹¤.

### 3.1 ì†ŒìŠ¤ë§µ ì—…ë¡œë“œ

Webpackì„ ê¸°ì¤€ìœ¼ë¡œ ì•„ë˜ì˜ ë°©ë²•ì„ ì‚¬ìš©í–ˆìŠµë‹ˆë‹¤. ìƒì„¸í•œ ë‚´ìš©ì€ [ê³µì‹ë¬¸ì„œ](https://docs.sentry.io/platforms/javascript/guides/wasm/sourcemaps/uploading/webpack/)ë¥¼ ì°¸ê³ í•´ì£¼ì„¸ìš”

1. í”ŒëŸ¬ê·¸ì¸ ì„¤ì¹˜

```
yarn add @sentry/webpack-plugin --save-dev
```

2. ì›¹íŒ© ì„¤ì • ìˆ˜ì •

```

const { sentryWebpackPlugin } = require("@sentry/webpack-plugin");

module.exports = {
  // ... other config above ...

  devtool: "source-map",
  plugins: [
    sentryWebpackPlugin({
      org: "example-org",
      project: "example-project",
      authToken: process.env.SENTRY_AUTH_TOKEN,
    }),
  ],
};

```

ì—¬ê¸°ì„œ SENTRY_AUTH_TOKENì˜ ê²½ìš° Sentry ì‚¬ì´íŠ¸ì—ì„œ API í† í°ì„ ìƒì„±í•´ì•¼í•©ë‹ˆë‹¤.

ì´ ì •ë³´ëŠ” Sentry APIì— ìš”ì²­ì„ ë³´ë‚¼ ë•Œ ì‚¬ìš©ë˜ë©°, ì´ë¥¼ í†µí•´ ì‚¬ìš©ìì˜ ì¸ì¦ì„ ê²€ì¦í•˜ê³  Sentry í”„ë¡œì íŠ¸ì— ì ‘ê·¼ì„ í—ˆìš©í•©ë‹ˆë‹¤.

í™˜ê²½ë³€ìˆ˜ íŒŒì¼ì€ `.env.sentry-build-plugin` íŒŒì¼ì— ì •ì˜í•´ ë¹Œë“œì‹œ ìë™ìœ¼ë¡œ ì†ŒìŠ¤ë§µì„ ì„œë²„ì— ìë™ìœ¼ë¡œ ì—…ë¡œë“œ ë  ìˆ˜ ìˆë„ë¡ í•©ë‹ˆë‹¤.

<img width="888" alt="á„‰á…³á„á…³á„…á…µá†«á„‰á…£á†º 2023-09-11 á„‹á…©á„Œá…¥á†« 12 26 02" src="https://github.com/teawon/Sentry-React-Practice/assets/78795820/cbca8a00-2a03-4b25-b8e7-97735495710a">

<img width="907" alt="image" src="https://github.com/teawon/Sentry-React-Practice/assets/78795820/1bd9883f-d644-4957-8833-e8f4199fd51a">

> ì†ŒìŠ¤ë§µ ì‚¬ìš© ì „ / í›„

## 4. ì•Œë¦¼ ë³´ë‚´ê¸°

ì ì´ì œ, ìˆ˜ì§‘ëœ ë¡œê·¸ë¥¼ ë¶„ì„í•˜ê³  ì—ëŸ¬ë¥¼ ë¹ ë¥´ê²Œ í•´ê²°í•´ì•¼í•©ë‹ˆë‹¤.

ê°€ì¥ ì¢‹ì€ ë°©ë²•ì€ íŠ¹ì • ë¬¸ì œìƒí™©ì— ëŒ€í•´ ë©”ì¼ì´ë‚˜ Slackì„ í†µí•´ ë¹ ë¥´ê²Œ ë°œìƒí•œ ì—ëŸ¬ë¥¼ ë¦¬í¬íŠ¸í•´ì•¼ê² ì£ .

![image](https://github.com/teawon/Sentry-React-Practice/assets/78795820/858b3499-8ffe-40cc-83c6-0afeaea9ce67)

> íšŸìˆ˜, ì—ëŸ¬ ì¢…ë¥˜, ë¬¸ì œ ìƒí™©ì„ í•„í„°ë§í•˜ê³  ì•Œë¦¼ì„ ë³´ë‚¼ ìˆ˜ ìˆë‹¤.
>
> [ë¬¸ì„œ](https://docs.sentry.io/product/integrations/notification-incidents/slack/)ì°¸ê³ 

ê²°ê³¼

<img width="662" alt="image" src="https://github.com/teawon/Sentry-React-Practice/assets/78795820/45829035-7887-4f7d-868a-1f75aecaa989">

## 5. ì‚¬ìš© í›„ê¸°

Sentryë¥¼ ì‚¬ìš©í•˜ê³ ë‚˜ì„œ, ëª‡ ê°€ì§€ ì‹¤ìˆ˜í–ˆë˜ ë¶€ë¶„ê³¼ ì¶”ê°€í–ˆë˜ì‚¬í•­ë“¤ì´ ìˆì—ˆìŠµë‹ˆë‹¤.

**[í´ë˜ìŠ¤ ìƒì†ì„ í†µí•œ íƒ€ì…ëª…ì‹œ]**

ì´ˆê¸°ì—ëŠ”, ê° ì—ëŸ¬ ë¡œê¹…ì„ ëª…í™•íˆ í•˜ê¸° ìœ„í•´ statusì½”ë“œì— ë”°ë¼ ë³„ë„ì˜ ìƒìˆ˜ë¥¼ ë§Œë“¤ê³  error.nameì†ì„±ì„ ì§ì ‘ ë°”ê¾¸ëŠ” ì‹ìœ¼ë¡œ ì‘ì—…ì„ í–ˆì—ˆìŠµë‹ˆë‹¤.

```javascript
if (error.response) {
  const { status } = error.response;
  errorType = STATUS_CODE_ERROR_MAP[status] || DEFAULT_ERROR_TYPE;
}

// {...}

Sentry.withScope((scope) => {
  scope.setContext("API Request Info", {
    url: originalRequest.url,
    method: originalRequest.method,
    status: error.response?.status,
    params: originalRequest.params,
    headers: originalRequest.headers,
  });

  scope.setContext("API Response Info", {
    data: JSON.stringify(error.response?.data, null, 2),
    headers: error.response?.headers,
  });

  scope.setFingerprint([
    originalRequest.method,
    error.response?.status,
    originalRequest.url,
  ]);

  error.name = errorType; // ì—¬ê¸°ì„œ ì´ë¦„ì„ ì§€ì •í•´ì„œ, Sentryë¡œê¹…ì— ì—ëŸ¬íƒ€ì…ì´ ëª…ì‹œë˜ë„ë¡ ìˆ˜ì •
  Sentry.captureException(error);
});
```

ê·¸ëŸ°ë°, ê¸°ì¡´ í”Œë¡œìš°ì— ë¬¸ì œê°€ ìƒê²¨ì„œ ì—ëŸ¬ë¥¼ í‘œí˜„í•˜ëŠ” Snackbarê°€ ë‚˜íƒ€ë‚˜ì§€ ì•ŠëŠ” ë¬¸ì œê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.

ì›ì¸ì€ ì°¸ì¡°íƒ€ì…ì¸ ì—ëŸ¬ ê°ì²´ ìì²´ì˜ ì†ì„±ì„ ë³€ê²½í•´ë²„ë ¤ì„œ, ë‹¤ë¥¸ ê³³ì˜ ì½”ë“œì—ë„ ì˜í–¥ì„ ë¯¸ì³¤ë˜ê²Œ ì›ì¸ì´ì˜€ê³ 

ì•„ë˜ì™€ ê°™ì´ ì—ëŸ¬ ë¡œê¹…ì„ ìœ„í•œ ì—ëŸ¬íƒ€ì…ì˜ ì§€ì •ì€ ë³„ë„ì˜ ê°ì²´ë¥¼ ìƒˆë¡œ ìƒì„±í•´ì„œ ìš”ì²­í•˜ë„ë¡ ì½”ë“œë¥¼ ìˆ˜ì •í–ˆìŠµë‹ˆë‹¤.

```javascript
Sentry.withScope((scope) => {
  scope.setContext("API Request Info", {
    url: originalRequest.url,
    method: originalRequest.method,
    status: error.response?.status,
    params: originalRequest.params,
    headers: originalRequest.headers,
  });

  scope.setContext("API Response Info", {
    data: JSON.stringify(error.response?.data, null, 2),
    headers: error.response?.headers,
  });

  scope.setFingerprint([
    originalRequest.method,
    error.response?.status,
    originalRequest.url,
  ]);

  Sentry.captureException(new SentryLoggingError(error)); // ë³„ë„ì˜ Errorê°ì²´ë¥¼ ìƒˆë¡œ ìƒì„± í›„ ì²˜ë¦¬
});

export class SentryLoggingError extends Error {
  constructor(error) {
    super(error.message);
    this.name = error.response.statusText;
    this.stack = error.stack;
    this.config = error.config;
    this.response = error.response;
  }
}
```

ì¶”ê°€ë¡œ statusTextë¥¼ ì‚¬ìš©í•´ì„œ ì—ëŸ¬ì´ë¦„ì„ ì²˜ë¦¬í–ˆëŠ”ë°, ë³„ë„ë¡œ ì—ëŸ¬ íƒ€ì…ì— ë”°ë¥¸ ìƒìˆ˜ë¥¼ ì²˜ë¦¬í•˜ì§€ ì•Šì•„ë„ ì˜ë¯¸ê°€ ì‹ë³„ë˜ê³ ,

ëª¨ë“  ìƒíƒœì½”ë“œì— ëŒ€í•œ ìƒìˆ˜ë¥¼ ë‹¤ ì •ì˜í•˜ì§€ ì•Šì•„ë„ ëœë‹¤ëŠ” ì¥ì ì´ ìˆì–´ì„œ ì¼ë‹¨ í•´ë‹¹ í•„ë“œê°’ì„ ì´ìš©í–ˆìŠµë‹ˆë‹¤.

ë¬¼ë¡  í–¥í›„ì— ìƒíƒœì½”ë“œì— ë”°ë¼ ë‹¤ë¥¸ statusTextë¥¼ ë¶„ë¦¬í•´ì•¼í•œë‹¤ë©´ ë³„ë„ì˜ ìƒìˆ˜ë¡œ ë¶„ë¦¬ë¥¼ í•´ì•¼ê² ì§€ë§Œìš”.

<br>

**[Error Boundaryì˜ ë„ì…]**

ì‚¬ì‹¤ ì²˜ìŒ Sentryì˜ ë„ì… ì˜ë„ëŠ” ë²„ê·¸ë¥¼ ë¹ ë¥´ê²Œ ê³ ì¹˜ê³ , ë””ë²„ê¹…ì„ ìš©ì´í•˜ê²Œ í•˜ê¸° ìœ„í•¨ì´ì˜€ìŠµë‹ˆë‹¤.

ê·¸ë¦¬ê³  ê±°ê¸°ì„œ ê°€ì¥ ì¤‘ìš”í–ˆë˜ ë²„ê·¸ëŠ” <u>ì˜ˆìƒì¹˜ ëª»í•œ ì—ëŸ¬ë¡œ ì¸í•´ ì•±ì´ ì¤‘ë‹¨ë˜ê³ , í° í˜ì´ì§€ê°€ í™”ë©´ìƒì— í‘œí˜„ë˜ëŠ”</u> ë¬¸ì œì ì´ì˜€ì£ .

ì´ ì—ëŸ¬ë¥¼ í¬ì°©í–ˆì„ë•Œ, ë³„ë„ì˜ ì—ëŸ¬ë¡œê¹…ì„ ë‚¨ê¸°ê¸° ìœ„í•´ì„œëŠ” ì´ íŠ¸ë¦¬ê±°ë¥¼ í¬ì°©í•˜ê³  ë¡œê·¸ë¥¼ ë³´ë‚¼ í•„ìš”ê°€ ìˆì—ˆìŠµë‹ˆë‹¤.

ì—¬ê¸°ì„œ Reactì˜ Error Boundaryë¥¼ ë„ì…í•´ ë¡œê¹…ê³¼ ë”ë¶ˆì™€ ì‚¬ìš©ìì—ê²Œ ë³„ë„ì˜ í˜ì´ì§€ë¥¼ ë Œë”ë§ í•  ìˆ˜ ìˆë„ë¡ ì¶”ê°€ì ì¸ ì‘ì—…ì„ ì§„í–‰í–ˆìŠµë‹ˆë‹¤.

> ErrorBoundaryë€?
>
> React ì»´í¬ë„ŒíŠ¸ë¡œ, ê·¸ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ì—ì„œ ë°œìƒí•˜ëŠ” JavaScript ì˜¤ë¥˜ë¥¼ ì¡ì•„ë‚´ê³ , ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ í‘œì‹œí•˜ê±°ë‚˜ ëŒ€ì²´ UIë¥¼ ë Œë”ë§í•˜ëŠ” ë° ì‚¬ìš©.
>
> ì¼ë°˜ì ìœ¼ë¡œ, JavaScriptì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ë©´ ì „ì²´ ì•±ì´ ì¤‘ë‹¨ë  ìˆ˜ ìˆì§€ë§Œ, ErrorBoundaryë¥¼ ì‚¬ìš©í•˜ë©´ íŠ¹ì • ì»´í¬ë„ŒíŠ¸ì˜ í•˜ìœ„ íŠ¸ë¦¬ì—ì„œë§Œ ì˜¤ë¥˜ê°€ ì²˜ë¦¬ë˜ê³  ì•±ì˜ ë‚˜ë¨¸ì§€ ë¶€ë¶„ì€ ì •ìƒì ìœ¼ë¡œ ë™ì‘í•œë‹¤.

![image](https://github.com/teawon/teawon.github.io/assets/78795820/014aadc8-e29d-4fa4-86aa-403dd7ee213f){:.center}

> ì•±ì´ ì¤‘ë‹¨ë˜ì—ˆì„ë•Œ ë³„ë„ì˜ í˜ì´ì§€ë¥¼ ë Œë”ë§í•¨ìœ¼ë¡œì¨ ì‚¬ìš©ì ê²½í—˜ì„ ë†’ì´ê³ , ì´ ìƒí™©ì— ëŒ€í•œ Slackì•Œë¦¼ì„ ë³´ë‚´ë„ë¡ ì²˜ë¦¬

<br>

**[ë°°í¬ì™€ ê°œë°œí™˜ê²½ì˜ ë¶„ë¦¬]**

```javascript
if (process.env.NODE_ENV === "production") {
  Sentry.init({
    dsn: process.env.REACT_APP_SENTRY_DSN,
    integrations: [
      new Sentry.BrowserTracing({
        tracePropagationTargets: [process.env.example_1, process.env.example_2],
      }),
      new Sentry.Replay(),
    ],
  });
}
```

ë¡œì»¬í™˜ê²½ì—ì„œ ë°œìƒí•˜ëŠ” ë¬´ë¶„ë³„í•œ ë¡œê·¸ê¸°ë¡ì„ ë¶„ë¦¬í•˜ê¸° ìœ„í•´ productioní™˜ê²½ì—ì„œë§Œ ì—ëŸ¬ë¥¼ ìˆ˜ì§‘í•  ìˆ˜ ìˆë„ë¡ ì¡°ê±´ë¬¸ì„ ì¶”ê°€í•˜ì˜€ìŠµë‹ˆë‹¤.

<br>

ê·¸ë˜ì„œ ì €ëŠ” ê²°ê³¼ì ìœ¼ë¡œ Sentryë„ì…ì„ í†µí•´ ì•„ë˜ì™€ ê°™ì€ ì´ì ì„ ì–»ì„ ìˆ˜ ìˆì—ˆë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤.

1. ì—ëŸ¬ ìƒí™©ì„ ë¹ ë¥´ê²Œ ê°ì§€í•˜ê³ , í•´ê²°ì— ìš©ì´í•˜ë„ë¡ ë””ë²„ê¹… ì œê³µ

2. ì‚¬ìš©ì í™˜ê²½ (íŠ¹íˆ ë¸Œë¼ìš°ì €..!)ì— ë”°ë¥¸ íŠ¹ì • ì—ëŸ¬ í™•ì¸

   > ì‹¤ì œ ì›¹ì‚¬ì´íŠ¸ ë²„ì „ì— ë”°ë¼ Array.at()í•¨ìˆ˜ë¥¼ ì§€ì›í•˜ì§€ ì•Šì•„ ë¸Œë¼ìš°ì €í™˜ê²½ì— ì¢…ì†ë˜ëŠ” ì—ëŸ¬ê°€ ë°œìƒí•œ ì¼€ì´ìŠ¤ë„ ìˆì—ˆìŠµë‹ˆë‹¤.

3. ì—ëŸ¬ë¥¼ ì¬í˜„í•˜ì§€ ëª»í•´ ê²ªì—ˆë˜ ì°ì°í•¨ì˜ í•´ì†ŒğŸ™Œ

ë²„ê·¸ê°€ ë°œìƒí•˜ì§€ ì•Šë„ë¡ ê°œë°œí•˜ëŠ”ê²Œ ê°€ì¥ ì´ìƒì ì´ê² ì§€ë§Œ, ì™„ì „í•œ ë¬´ê²°ì ì˜ í”„ë¡œê·¸ë¨ì„ ë§Œë“œëŠ”ê±´ ë¶ˆê°€ëŠ¥í•˜ë‹¤ê³  ìƒê°í•©ë‹ˆë‹¤.

ë‹¤ë§Œ ë¹ ë¥´ê²Œ ë²„ê·¸ë¥¼ ì°¾ì•„ ìˆ˜ì •í•  ìˆ˜ ìˆëŠ” ê°œë°œí™˜ê²½ì„ ë§ˆë ¨í•˜ê³  ê³„ì†í•´ì„œ ê°œì„ í•´ë‚˜ì•„ê°€ì•¼í–ˆê³  ì´ëŸ° ë¶€ë¶„ì— ë„ì›€ì„ ì£¼ëŠ” Sentryë¥¼ ë„ì…í–ˆë˜ê²Œ ì¢‹ì€ ê²½í—˜ì´ ë˜ì—ˆë˜ê±°ê°™ìŠµë‹ˆë‹¤.

## ì°¸ê³ ìë£Œ

[https://tech.kakaopay.com/post/frontend-sentry-monitoring/](https://tech.kakaopay.com/post/frontend-sentry-monitoring/)

[https://speakerdeck.com/kakao/sentryreul-iyonghan-ereo-cujeoggi-reactyi-seoneonjeog-ereo-ceori](https://speakerdeck.com/kakao/sentryreul-iyonghan-ereo-cujeoggi-reactyi-seoneonjeog-ereo-ceori)

[ê³µì‹ë¬¸ì„œ](https://docs.sentry.io/platforms/javascript/guides/react/?original_referrer=https%3A%2F%2Ftech.kakaopay.com%2F)
